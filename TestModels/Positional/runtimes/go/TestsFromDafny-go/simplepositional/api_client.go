// Code generated by smithy-go-codegen DO NOT EDIT.

package simplepositional

import (
	"context"
	"fmt"
	"reflect"

	SimpleResources "github.com/Smithy-dafny/TestModels/Positional/SimpleResource"

	"github.com/Smithy-dafny/TestModels/Positional/simplepositionalinternaldafny"
	"github.com/Smithy-dafny/TestModels/Positional/simplepositionalinternaldafnytypes"
	"github.com/Smithy-dafny/TestModels/Positional/simplepositionaltypes"
	"github.com/dafny-lang/DafnyRuntimeGo/dafny"
)

type Client struct {
	DafnyClient *simplepositionalinternaldafny.SimplePositionalClient
}

func NewClient(clientConfig simplepositionaltypes.SimplePositionalConfig) (*Client, error) {
	var dafnyConfig = SimplePositionalConfig_ToDafny(clientConfig)
	var dafny_response = simplepositionalinternaldafny.Companion_Default___.SimplePositional(dafnyConfig)
	if dafny_response.Is_Failure() {
		panic("Client construction failed. This should never happen")
	}
	var dafnyClient = dafny_response.Extract().(*simplepositionalinternaldafny.SimplePositionalClient)
	client := &Client{dafnyClient}
	return client, nil
}

func (client *Client) GetResource(ctx context.Context, params simplepositionaltypes.GetResourceInput) (*simplepositionaltypes.GetResourceOutput, error) {
	err := params.Validate()
	if err != nil {
		opaqueErr := &simplepositionaltypes.OpaqueError{
			ErrObject: err,
		}
		return nil, opaqueErr
	}
	var dafny_request simplepositionalinternaldafnytypes.GetResourceInput = GetResourceInput_ToDafny(params)
	var dafny_response = client.DafnyClient.GetResource(dafny_request)

	if dafny_response.Is_Failure() {
		err := dafny_response.Dtor_error().(simplepositionalinternaldafnytypes.Error)
		return nil, Error_FromDafny(err)
	}
	var native_response = GetResourceOutput_FromDafny(dafny_response.Extract().(simplepositionalinternaldafnytypes.GetResourceOutput))
	return &native_response, nil

}

func (client *Client) GetResourcePositional(ctx context.Context, params simplepositionaltypes.GetResourcePositionalInput) (*SimpleResources.SimpleResource, error) {
	
	err := params.Validate()
	if err != nil {
		opaqueErr := &simplepositionaltypes.OpaqueError{
			ErrObject: err,
		}
		return nil, opaqueErr
	}
	var dafny_request dafny.Sequence = GetResourcePositionalInput_ToDafny(params)
	var dafny_response = client.DafnyClient.GetResourcePositional(dafny_request)
	
	if dafny_response.Is_Failure() {
		err := dafny_response.Dtor_error().(simplepositionalinternaldafnytypes.Error)
		return nil, Error_FromDafny(err)
	}
	fmt.Println(reflect.TypeOf(dafny_response.Extract()))
	var native_response = dafny_response.Extract().(*SimpleResources.SimpleResource)
	return native_response, nil

}
